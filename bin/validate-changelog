#!/bin/bash
#

set -o errexit

declare -r version="$1"

function check-in-file {
    local -r pattern="$1"
    local -r file="$2"

    grep -q "$pattern" "$file" ||
        fail "Missing changelog entry for version '$version' in file: $file"
}
function if-file-exists-then-check {
    local -r pattern="$1"
    local -r file="$2"

    if [[ -f "$file" ]]; then
        check-in-file "$pattern" "$file"
    else
        return 0
    fi
}


if-file-exists-then-check "^# $version" Changelog.md
if-file-exists-then-check "^$version$" src/docs/releasenotes.rst

exit 0
